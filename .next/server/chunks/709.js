exports.id=709,exports.ids=[709],exports.modules={46230:(e,r,s)=>{Promise.resolve().then(s.bind(s,85072)),Promise.resolve().then(s.bind(s,16566)),Promise.resolve().then(s.bind(s,91721)),Promise.resolve().then(s.bind(s,72248))},41706:(e,r,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},54072:(e,r,s)=>{Promise.resolve().then(s.bind(s,85911))},85911:(e,r,s)=>{"use strict";s.d(r,{default:()=>d});var t=s(10326),a=s(17577),i=s(90434),n=s(35047),o=s(45038),u=s(46226);let d=()=>{let e=(0,n.useRouter)(),r=(0,n.usePathname)(),[s,d]=(0,a.useState)(()=>!r.includes("admin"));return t.jsx(t.Fragment,{children:t.jsx("nav",{className:"bg-sky-950",children:t.jsx("div",{className:"mx-auto max-w-7xl px-2 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"relative flex h-16 items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-1 items-center justify-center sm:items-stretch sm:justify-start",children:[t.jsx("div",{className:"flex flex-shrink-0 items-center",children:t.jsx(u.default,{width:100,height:100,className:"w-auto h-7 sm:h-8",src:"https://merakiui.com/images/logo.svg",alt:""})}),t.jsx("div",{className:"hidden sm:ml-6 sm:block",children:t.jsx("div",{className:"flex space-x-4",children:s?(0,t.jsxs)(t.Fragment,{children:[t.jsx(i.default,{href:"/user/ticket",className:"rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",children:"Tickets"}),t.jsx(i.default,{href:"/user/feedback",className:"rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",children:"Feedbacks"}),t.jsx(i.default,{href:"/user/survey",className:"rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white cursor-pointer",children:"Surveys"})]}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(i.default,{href:"/admin/dashboard",className:"rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white cursor-pointer",children:"DashBoard"}),t.jsx(i.default,{href:"/admin/ticket",className:"rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",children:"Tickets"}),t.jsx(i.default,{href:"/admin/feedback",className:"rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",children:"Feedbacks"}),t.jsx(i.default,{href:"/admin/survey",className:"rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",children:"Surveys"}),t.jsx(i.default,{href:"/admin/manage-users",className:"rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white",children:"Manange Users"})]})})})]}),(0,t.jsxs)("button",{className:"rounded-md min-w-20 bg-gray-700 px-3 py-2 mx-10 text-sm font-medium text-gray-200 hover:bg-gray-950 hover:text-white",onClick:function(){if(r.includes("user")){if(r.includes("feedback"))e.push("/admin/feedback");else if(r.includes("survey"))e.push("/admin/survey");else{let s=r.replace("user","admin");e.push(s)}}else if(r.includes("admin")){if(r.includes("dashboard")||r.includes("manage-users"))e.push("/user/ticket");else if(r.includes("survey"))e.push("/user/survey");else{let s=r.replace("admin","user");e.push(s)}}},children:["SWITCH TO ",s&&t.jsx(t.Fragment,{children:"ADMIN"})||t.jsx(t.Fragment,{children:"USER"})]}),t.jsx(o.l8,{})]})})})})}},32029:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>u,metadata:()=>o});var t=s(19510),a=s(25384),i=s.n(a);s(5023);var n=s(7311);let o={title:"Home",description:"Generated by create next app"};async function u({children:e}){return t.jsx(n.El,{children:t.jsx("html",{lang:"en",children:t.jsx("body",{className:i().className,children:e})})})}},33266:(e,r,s)=>{"use strict";s.d(r,{Z:()=>o});var t=s(19510);s(71159);var a=s(35686),i=s(15803),n=s(92153);function o(){let{userId:e}=(0,a.I)();async function r(){let e=await (0,i.a)();(0,n.userCreationFlow)(e)}return e&&r(),t.jsx(t.Fragment,{})}},24890:(e,r,s)=>{"use strict";s.d(r,{ZP:()=>o});var t=s(68570);let a=(0,t.createProxy)(String.raw`D:\EX2Projects\CurrentProjects\HRSQUARED\HRSquared\src\components\ui\Navbar.tsx`),{__esModule:i,$$typeof:n}=a;a.default;let o=(0,t.createProxy)(String.raw`D:\EX2Projects\CurrentProjects\HRSQUARED\HRSquared\src\components\ui\Navbar.tsx#default`)},24925:(e,r,s)=>{"use strict";let t;s.d(r,{C:()=>o});var a=s(35900);let{Pool:i}=s.n(a)(),n=new i({user:"tmsdb_stli_user",password:"e9xMpaWVMWOG6mepVfFQd8uY6XaUDv4F",host:"dpg-cof58cocmk4c7380j3l0-a.oregon-postgres.render.com",database:"tmsdb_stli",ssl:!0}),o=async()=>t||(t=await n.connect())},92153:(e,r,s)=>{"use strict";s.r(r),s.d(r,{checkUserExistence:()=>f,checkUserPermissionForSurvey:()=>y,createUser:()=>m,getAllUsers:()=>o,getAllUsersToAssign:()=>u,getUserById:()=>d,getUserFromDb:()=>n,getUserIdFromClerkId:()=>x,getUsersFormData:()=>c,updateUserRoleMapping:()=>l,userCreationFlow:()=>g});var t=s(24330);s(60166);var a=s(58585),i=s(24925);async function n(e,r){let s={text:`select u.id, u.username, u.email, r.rolename
        from users u
        left join userrole_mapping um
        on u.id = um.user_id
        left join roles r
        on um.role_id = r.id
        where u.email=$1 and password=$2;`,values:[e,r]},t=await (0,i.C)(),n=await t.query(s);if(n.rowCount>0)return n.rows;(0,a.notFound)()}async function o(){let e=`
    select users.id, users.username, users.email, roles.rolename, groups.groupname, category.categoryname, um.can_create_survey
    from userrole_mapping um
    left join users on users.id = um.user_id
    left join roles on roles.id = um.role_id
    left join groups on groups.id = um.group_id
    left join category on category.id = um.category_id
    where users.isActive = true;`,r=await (0,i.C)(),s=await r.query(e);if(s.rowCount>0)return s.rows;(0,a.notFound)()}async function u(){let e=await (0,i.C)(),r=await e.query("select u.id, u.username, u.email from users u;");if(r.rowCount>0)return r.rows;(0,a.notFound)()}async function d(e){let r={text:`
        select users.id, users.username, users.email, roles.rolename, groups.groupname, category.categoryname, um.can_create_survey
        from userrole_mapping um
        left join users on users.id = um.user_id
        left join roles on roles.id = um.role_id
        left join groups on groups.id = um.group_id
        left join category on category.id = um.category_id
        where users.isActive = true and users.id=$1`,values:[e]},s=await (0,i.C)(),t=await s.query(r);if(t.rowCount>0)return t.rows;(0,a.notFound)()}async function l(e){let r={text:`update userrole_mapping
    set role_id=$1, group_id=$2, category_id=$3,can_create_survey=$4
    where user_id=$5`,values:[e.role_id,e.group_id,e.category_id,e.can_create_survey,e.user_id]};try{let e=await (0,i.C)();await e.query(r)}catch(e){console.log(e),(0,a.notFound)()}}async function c(){let e=await (0,i.C)(),r=await e.query("select * from roles"),s=await e.query("select * from groups"),t=await e.query("select * from category");return{roles:r.rows,groups:s.rows,categories:t.rows}}async function m(e){let r=await (0,i.C)(),s={text:"insert into users (username, email, password, isactive, clerk_id) values ($1, $2, $3, $4, $5)",values:[e.username,e.email,e.password,e.isactive,e.clerk_id]};return(await r.query(s)).rows}async function f(e){let r=await (0,i.C)();return 0!=(await r.query({text:"select clerk_id from users where clerk_id=$1",values:[e]})).rows.length&&(console.log("user already exists"),!0)}async function h(e){if(!e)return;let r={username:`${e.firstName} ${e.lastName}`,email:`${e.emailAddresses[0].emailAddress}`,password:"clerk",isactive:!0,clerk_id:e.id};console.log(r),m(r)}async function g(e){if(e||console.log("user does not exist"),!await f(e.id))return h(e),"creating user"}async function x(e){let r=await (0,i.C)(),s=await r.query({text:'select id from "users" where clerk_id=$1',values:[e]});return null==s.rows[0].id?1:s.rows[0].id}async function y(e,r){if(null==r)return(0,a.notFound)();let s=await (0,i.C)(),t=await x(r);console.log("permission actual user id: ",t);let n=await s.query({text:"select category from surveys where id=$1",values:[e]});if(n.rows[0]?.category==null)return!0;let o={text:`select urm.id 
    from userrole_mapping urm
    join surveys s on s.category = urm.group_id
    where urm.user_id = $1  and s.id = $2
    `,values:[t,e]},u=await s.query(o);return console.log("***************this is result",u),u.rowCount>0}(0,s(40618).h)([n,o,u,d,l,c,m,f,g,x,y]),(0,t.j)("bfb948864d3a9223fe1b23007ea4ecc247e7419e",n),(0,t.j)("ef8258559ec09924b33df9cdb206b83c322e79bf",o),(0,t.j)("258046a1e3860fa89174224a272f0cdf55590a87",u),(0,t.j)("f7abf20a8088752418c2e27ab26067e3f68fe53d",d),(0,t.j)("5929f08dcffcabce9ece9ec262c4d1da2aec33a2",l),(0,t.j)("8b3bb30f46c0d6e334351cdbc6f39faf04c6bdb7",c),(0,t.j)("a448f998d28c1535f4ba9b2d14794207c3b56e92",m),(0,t.j)("d16ec756617f7017d927ecb303b422c45c2b5f8f",f),(0,t.j)("4858cff1d6c3cbafd4219b6ca1e3648ed5c80d77",g),(0,t.j)("deb9a62e45009688455aa5d6d724f09a72e9c0c6",x),(0,t.j)("c3a6fc5c59e2081ad90a6af0191920ab22d8d718",y)},73881:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>a});var t=s(66621);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,t.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};