(()=>{var e={};e.id=938,e.ids=[938],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},35900:e=>{"use strict";e.exports=require("pg")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},75916:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>c.a,__next_app__:()=>b,originalPathname:()=>u,pages:()=>o,routeModule:()=>f,tree:()=>l}),s(80898),s(59102),s(32029),s(35866);var r=s(23191),a=s(88716),i=s(37922),c=s.n(i),d=s(95231),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);s.d(t,n);let l=["",{children:["user",{children:["ticket",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,80898)),"D:\\EX2Projects\\CurrentProjects\\HRSQUARED\\HRSquared\\src\\app\\user\\ticket\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,59102)),"D:\\EX2Projects\\CurrentProjects\\HRSQUARED\\HRSquared\\src\\app\\user\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,32029)),"D:\\EX2Projects\\CurrentProjects\\HRSQUARED\\HRSquared\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["D:\\EX2Projects\\CurrentProjects\\HRSQUARED\\HRSquared\\src\\app\\user\\ticket\\page.tsx"],u="/user/ticket/page",b={require:s,loadChunk:()=>Promise.resolve()},f=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/user/ticket/page",pathname:"/user/ticket",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},79025:(e,t,s)=>{let r={"0d3b394a6f5b2ee7d22e897eaecc161123665419":()=>Promise.resolve().then(s.bind(s,24871)).then(e=>e.getAssignedTickets),"6b04dd2f52e628e3ef8237caef2a3981589e0945":()=>Promise.resolve().then(s.bind(s,24871)).then(e=>e.getAllTickets),"75a8f0df29fbc5d9ed038a63256389ddcaf318c4":()=>Promise.resolve().then(s.bind(s,24871)).then(e=>e.getTicketFormData),"777da57429d2269445386e1c1705a5a5327ec0fd":()=>Promise.resolve().then(s.bind(s,24871)).then(e=>e.addTicket),"92a6dade841af0fa08376101f1391bd44b18dafb":()=>Promise.resolve().then(s.bind(s,24871)).then(e=>e.updateStatus),ab9d7ea00ff0dbb00ad42d5a0edc121994b61750:()=>Promise.resolve().then(s.bind(s,24871)).then(e=>e.getUserTickets),b6558d937610141ed48787f4792a92cd116d0873:()=>Promise.resolve().then(s.bind(s,24871)).then(e=>e.AssignUser),c209c09362fa20cbed56af258953b52262feaccc:()=>Promise.resolve().then(s.bind(s,24871)).then(e=>e.getRowByCategory),f4c14cd734994430527605c5c534be48cfc3582a:()=>Promise.resolve().then(s.bind(s,24871)).then(e=>e.deligateTicket),"258046a1e3860fa89174224a272f0cdf55590a87":()=>Promise.resolve().then(s.bind(s,92153)).then(e=>e.getAllUsersToAssign),"4858cff1d6c3cbafd4219b6ca1e3648ed5c80d77":()=>Promise.resolve().then(s.bind(s,92153)).then(e=>e.userCreationFlow),"5929f08dcffcabce9ece9ec262c4d1da2aec33a2":()=>Promise.resolve().then(s.bind(s,92153)).then(e=>e.updateUserRoleMapping),"8b3bb30f46c0d6e334351cdbc6f39faf04c6bdb7":()=>Promise.resolve().then(s.bind(s,92153)).then(e=>e.getUsersFormData),a448f998d28c1535f4ba9b2d14794207c3b56e92:()=>Promise.resolve().then(s.bind(s,92153)).then(e=>e.createUser),bfb948864d3a9223fe1b23007ea4ecc247e7419e:()=>Promise.resolve().then(s.bind(s,92153)).then(e=>e.getUserFromDb),c3a6fc5c59e2081ad90a6af0191920ab22d8d718:()=>Promise.resolve().then(s.bind(s,92153)).then(e=>e.checkUserPermissionForSurvey),d16ec756617f7017d927ecb303b422c45c2b5f8f:()=>Promise.resolve().then(s.bind(s,92153)).then(e=>e.checkUserExistence),deb9a62e45009688455aa5d6d724f09a72e9c0c6:()=>Promise.resolve().then(s.bind(s,92153)).then(e=>e.getUserIdFromClerkId),ef8258559ec09924b33df9cdb206b83c322e79bf:()=>Promise.resolve().then(s.bind(s,92153)).then(e=>e.getAllUsers),f7abf20a8088752418c2e27ab26067e3f68fe53d:()=>Promise.resolve().then(s.bind(s,92153)).then(e=>e.getUserById)};async function a(e,...t){return(await r[e]()).apply(null,t)}e.exports={"0d3b394a6f5b2ee7d22e897eaecc161123665419":a.bind(null,"0d3b394a6f5b2ee7d22e897eaecc161123665419"),"6b04dd2f52e628e3ef8237caef2a3981589e0945":a.bind(null,"6b04dd2f52e628e3ef8237caef2a3981589e0945"),"75a8f0df29fbc5d9ed038a63256389ddcaf318c4":a.bind(null,"75a8f0df29fbc5d9ed038a63256389ddcaf318c4"),"777da57429d2269445386e1c1705a5a5327ec0fd":a.bind(null,"777da57429d2269445386e1c1705a5a5327ec0fd"),"92a6dade841af0fa08376101f1391bd44b18dafb":a.bind(null,"92a6dade841af0fa08376101f1391bd44b18dafb"),ab9d7ea00ff0dbb00ad42d5a0edc121994b61750:a.bind(null,"ab9d7ea00ff0dbb00ad42d5a0edc121994b61750"),b6558d937610141ed48787f4792a92cd116d0873:a.bind(null,"b6558d937610141ed48787f4792a92cd116d0873"),c209c09362fa20cbed56af258953b52262feaccc:a.bind(null,"c209c09362fa20cbed56af258953b52262feaccc"),f4c14cd734994430527605c5c534be48cfc3582a:a.bind(null,"f4c14cd734994430527605c5c534be48cfc3582a"),"258046a1e3860fa89174224a272f0cdf55590a87":a.bind(null,"258046a1e3860fa89174224a272f0cdf55590a87"),"4858cff1d6c3cbafd4219b6ca1e3648ed5c80d77":a.bind(null,"4858cff1d6c3cbafd4219b6ca1e3648ed5c80d77"),"5929f08dcffcabce9ece9ec262c4d1da2aec33a2":a.bind(null,"5929f08dcffcabce9ece9ec262c4d1da2aec33a2"),"8b3bb30f46c0d6e334351cdbc6f39faf04c6bdb7":a.bind(null,"8b3bb30f46c0d6e334351cdbc6f39faf04c6bdb7"),a448f998d28c1535f4ba9b2d14794207c3b56e92:a.bind(null,"a448f998d28c1535f4ba9b2d14794207c3b56e92"),bfb948864d3a9223fe1b23007ea4ecc247e7419e:a.bind(null,"bfb948864d3a9223fe1b23007ea4ecc247e7419e"),c3a6fc5c59e2081ad90a6af0191920ab22d8d718:a.bind(null,"c3a6fc5c59e2081ad90a6af0191920ab22d8d718"),d16ec756617f7017d927ecb303b422c45c2b5f8f:a.bind(null,"d16ec756617f7017d927ecb303b422c45c2b5f8f"),deb9a62e45009688455aa5d6d724f09a72e9c0c6:a.bind(null,"deb9a62e45009688455aa5d6d724f09a72e9c0c6"),ef8258559ec09924b33df9cdb206b83c322e79bf:a.bind(null,"ef8258559ec09924b33df9cdb206b83c322e79bf"),f7abf20a8088752418c2e27ab26067e3f68fe53d:a.bind(null,"f7abf20a8088752418c2e27ab26067e3f68fe53d")}},137:(e,t,s)=>{Promise.resolve().then(s.bind(s,98457))},98457:(e,t,s)=>{"use strict";s.d(t,{default:()=>f});var r,a=s(10326),i=s(17577),c=s(36204),d=s(90434);let n=function(){return a.jsx(d.default,{href:"/user/ticket/new",className:"inline-block cursor-pointer rounded-md bg-[#46a46c] p-2 text-white",children:a.jsx("div",{children:"+ Add Ticket"})})};var l=s(25988),o=s(27324);let u=(e,t,s)=>{let r=(t-1)*s;return e.slice(r,r+s)};function b({ticketData:e}){let[t,s]=(0,i.useState)(1),[r,c]=(0,i.useState)([{}]),[b,f]=(0,i.useState)(""),[p,x]=(0,i.useState)(e),[h,m]=(0,i.useState)([]),[g,y]=(0,i.useState)(!1),[v,j]=(0,i.useState)(null),w=e=>{if(e==b){c([{}]),f("");return}f(e);let r=p.filter(t=>t.status==e);c(r),s(1),m(u(r,t,11))};return a.jsx("div",{className:"",children:g?(0,a.jsxs)("div",{className:"fixed top-0 left-0 w-screen h-screen z-[99999999999999] flex flex-col items-center justify-center bg-black/40",children:[a.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-white"})," ",a.jsx("h3",{children:"Fetching Tickets ..."})," "]}):(0,a.jsxs)("div",{children:[v&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 top-0 flex flex-col items-center justify-center bg-slate-500 bg-opacity-70 ",children:(0,a.jsxs)("div",{className:"relative rounded-md bg-white ",children:[a.jsx("div",{className:"absolute -right-3 -top-3  rounded-full bg-slate-600 px-3 py-1  text-white",children:a.jsx("button",{onClick:e=>{j(null),e.preventDefault()},children:"X"})}),a.jsx("div",{className:"flex w-fit max-w-sm flex-col items-center justify-center ",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 ",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4  rounded-t-md bg-indigo-500 px-7 py-5 text-white",children:[(0,a.jsxs)("div",{children:["#",v.id]}),a.jsx("div",{className:"text-2xl",children:v.title}),a.jsx("div",{className:`${"Open"==v.status?"bg-red-500":"Resolved"==v.status?"bg-green-500 ":"bg-yellow-500 "}  rounded-full px-2 py-1 text-sm text-white`,children:v.status})]}),a.jsx("div",{className:"px-7  text-lg",children:v.description}),(0,a.jsxs)("div",{className:" px-7 py-5",children:[(0,a.jsxs)("div",{className:"bg-gray text-sm text-zinc-400",children:["Opened at : ",(0,o.i)(v.createdat)]}),"Open"==v.status?a.jsx("div",{className:"flex justify-center"}):(0,a.jsxs)("div",{className:"bg-gray text-sm text-zinc-400",children:["Closed at : ",(0,o.i)(v.closedat)]})]})]})})]})}),(0,a.jsxs)("div",{className:"flex items-stretch",children:[(0,a.jsxs)("div",{className:"w-[18%] items-stretch bg-slate-100",children:[a.jsx("div",{className:"mx-2 my-1 mt-2 text-xl",children:"Filters"}),a.jsx("div",{className:`${"Resolved"==b?"border-sky-500 text-sky-500":"border-gray-300 text-gray-400"} m-2  inline-block cursor-pointer rounded-lg border-2 px-4 py-2`,onClick:()=>w("Resolved"),children:"Resolved"}),a.jsx("div",{className:`${"Open"==b?"border-sky-500 text-sky-500":"border-gray-300 text-gray-400"} inline-block  cursor-pointer rounded-lg border-2 px-4 py-2 `,onClick:()=>w("Open"),children:"Open"})]}),(0,a.jsxs)("div",{className:"w-[82%]",children:[(0,a.jsxs)("div",{className:"flex items-center  justify-between px-7 py-6",children:[a.jsx(n,{}),a.jsx("div",{children:a.jsx(d.default,{href:{pathname:"./ticket/me"},className:"inline-block cursor-pointer rounded-md bg-[#4b62f8]  p-2 text-white",children:"Assigned To Me"})})]}),(0,a.jsxs)("table",{className:"w-[100%]",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{className:" m-10 bg-gray-200/50",children:[a.jsx("th",{className:"px-10 py-3 text-left",children:"Assigned To"}),a.jsx("th",{className:"px-10 py-3 text-left",children:"Title"}),a.jsx("th",{className:"px-10 py-3 text-left",children:"Status"}),a.jsx("th",{className:"px-10 py-3 text-left",children:"Created on"}),a.jsx("th",{className:"px-10 py-3 text-left",children:"Details"})]})}),a.jsx("tbody",{children:h.map(e=>(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"border-b border-sky-500 px-10 py-3",children:e.assignedto||a.jsx("div",{className:"text-zinc-400",children:"Yet to assigned"})}),a.jsx("td",{className:"border-b border-sky-500 px-10 py-3",children:e.title}),a.jsx("td",{className:"border-b border-sky-500 px-10 py-3",children:a.jsx("span",{className:`${"Open"==e.status?"text-[#f03e3e] bg-[#f03e3e1a]":"Resolved"==e.status?"text-[#14ae6d] bg-[#e7f5f0]":"text-[#D68D00] bg-[#D68D001A] "}  rounded-full px-2 py-1 text-sm `,children:e.status})}),a.jsx("td",{className:"border-b border-sky-500 px-10 py-3",children:(0,o.i)(e.createdat)}),a.jsx("td",{className:"border-b border-sky-500",onClick:()=>j(e),children:a.jsx("span",{className:" cursor-pointer rounded-full bg-blue-200   px-3 py-1 text-sm text-blue-500 hover:bg-blue-100",children:"View Details"})})]},e.ticket_id))})]}),a.jsx(l.Z,{items:""==b?p.length:r.length,currentPage:t,pageSize:11,onPageChange:e=>{s(e)}})]})]})]})})}!function(e){e[e.All=0]="All",e[e.Today=1]="Today",e[e.OneWeek=2]="OneWeek",e[e.OneMonth=3]="OneMonth",e[e.OneYear=4]="OneYear"}(r||(r={}));let f=function({surveyData:e}){let[t,s]=(0,i.useState)([]),[r,d]=(0,i.useState)(0),[n,l]=(0,i.useState)(),[o,u]=(0,i.useState)(""),[f,p]=(0,i.useState)([]),x=e=>{let t=e.target.value;d(t),console.log("Selection Value",t)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center relative mx-4 my-4",children:[a.jsx(c.Z,{onChangeCallback:e=>{u(e);let t=f.filter(t=>t.title.toLowerCase().includes(e.toLowerCase())||t.description.toLowerCase().includes(e.toLowerCase())||null!=t.assignedto&&t.assignedto.trim().toLowerCase().includes(e.toLowerCase()));console.log("bbb",t),s(t)},placeholder:"Search Tickets"}),(0,a.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[a.jsx("label",{htmlFor:"my-select",className:"font-medium text-gray-700",children:"Sort by:"}),(0,a.jsxs)("select",{id:"my-select",className:"w-[180px] px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",onChange:e=>x(e),children:[a.jsx("option",{value:0,children:"All Time"}),a.jsx("option",{value:1,children:"Today"}),a.jsx("option",{value:2,children:"Last one week"}),a.jsx("option",{value:3,children:"Last one month"}),a.jsx("option",{value:4,children:"Last one year"})]})]})]}),a.jsx(b,{ticketData:t})]})}},36204:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s(10326),a=s(17577);let i=({onChangeCallback:e,placeholder:t})=>{let[s,i]=(0,a.useState)("");return(0,r.jsxs)("div",{className:"flex items-center gap-2 border-2 border-gray-300 rounded-full overflow-hidden px-2 has-[:focus]:border-sky-300",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",width:"25px",height:"25px",children:r.jsx("path",{d:"M 21 3 C 11.601563 3 4 10.601563 4 20 C 4 29.398438 11.601563 37 21 37 C 24.355469 37 27.460938 36.015625 30.09375 34.34375 L 42.375 46.625 L 46.625 42.375 L 34.5 30.28125 C 36.679688 27.421875 38 23.878906 38 20 C 38 10.601563 30.398438 3 21 3 Z M 21 7 C 28.199219 7 34 12.800781 34 20 C 34 27.199219 28.199219 33 21 33 C 13.800781 33 8 27.199219 8 20 C 8 12.800781 13.800781 7 21 7 Z"})}),r.jsx("input",{className:" bg-white h-[2rem] px-5 rounded-lg text-sm focus:outline-none w-full",type:"search",value:s,onChange:t=>{let s=t.target.value;i(s),e&&e(s)},name:"search",placeholder:t})]})}},25988:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var r=s(10326),a=s(71627),i=s.n(a);let c=({items:e,pageSize:t,currentPage:s,onPageChange:a})=>{console.log("items -> ",e);let c=Math.ceil(e/t);if(1===c)return null;let d=Array.from({length:c},(e,t)=>t+1);return r.jsx("div",{children:r.jsx("ul",{className:i().pagination,children:d.map(e=>r.jsx("li",{className:e===s?i().pageItemActive:i().pageItem,onClick:()=>a(e),children:r.jsx("a",{className:i().pageLink,children:e})},e))})})}},27324:(e,t,s)=>{"use strict";s.d(t,{i:()=>r});let r=e=>{if(!e)return"";let t=new Date(e),s=t.getUTCMonth()+1,r=t.getUTCFullYear(),a=t.getUTCDate(),i=["January","February","March","April","May","June","July","August","September","October","November","December"][s-1];return`${i} ${a}, ${r}`}},71627:e=>{e.exports={container:"Pagination_container__K2pXc",pagination:"Pagination_pagination__YO7tt",pageLink:"Pagination_pageLink__Dbtuc",pageItem:"Pagination_pageItem__S74oz",pageItemActive:"Pagination_pageItemActive__tUfHZ"}},59102:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d,metadata:()=>c});var r=s(19510),a=s(24890),i=s(33266);let c={title:"Next.js",description:"Generated by Next.js"};function d({children:e}){return r.jsx("html",{lang:"en",children:(0,r.jsxs)("body",{children:[r.jsx(a.ZP,{}),e,r.jsx(i.Z,{})]})})}},80898:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(19510),a=s(71159),i=s(24871),c=s(68570);let d=(0,c.createProxy)(String.raw`D:\EX2Projects\CurrentProjects\HRSQUARED\HRSquared\src\app\user\ticket\UserTicketSearch.tsx`),{__esModule:n,$$typeof:l}=d;d.default;let o=(0,c.createProxy)(String.raw`D:\EX2Projects\CurrentProjects\HRSQUARED\HRSquared\src\app\user\ticket\UserTicketSearch.tsx#default`);var u=s(75571),b=s(46509);async function f(){let e=await (0,u.getServerSession)(b.v);if(!e)return null;let t=e.user.token.sub;return console.log(t),t}async function p(){let e=await f();console.log("UUUUSSSSSEEEERRR",e);let t=await (0,i.getUserTickets)(e);return r.jsx(o,{surveyData:t})}function x(){return r.jsx("div",{children:r.jsx(a.Suspense,{fallback:(0,r.jsxs)("div",{className:"fixed top-0 left-0 w-screen h-screen z-[99999999999999] flex flex-col items-center justify-center bg-black/40",children:[r.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-white"})," ",r.jsx("h3",{children:"Fetching Tickets ..."})," "]}),children:r.jsx(p,{})})})}},24871:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AssignUser:()=>b,addTicket:()=>u,deligateTicket:()=>p,getAllTickets:()=>h,getAssignedTickets:()=>m,getRowByCategory:()=>o,getTicketFormData:()=>g,getUserTickets:()=>x,updateStatus:()=>f});var r=s(24330);s(60166);var a=s(24925),i=s(55245);let c=async e=>{let t=i.createTransport({service:"Gmail",auth:{user:process.env.EMAIL_ADDRESS,pass:process.env.EMAIL_PASSWORD}}),s={from:"ADMIN",to:e.to,subject:e.subject,html:e.message};await t.sendMail(s)};var d=s(92153),n=s(40618);let l=` SELECT
tickets.id as ticket_id,
tickets.title as title,
tickets.description as description,
category.categoryname AS category,
ticketpriority.name AS priority,
ticketstatus.name AS status,
users_createdby.username AS createdby,
tickets.createdat,
users_assignedto.username AS assignedto,
users_closedby.username AS closedby,
tickets.closedat
FROM
    tickets
LEFT JOIN
    category ON tickets.subcategory_id = category.id
LEFT JOIN
    ticketpriority ON tickets.priority = ticketpriority.id
LEFT JOIN
    ticketstatus ON tickets.status = ticketstatus.id
LEFT JOIN
    users AS users_createdby ON tickets.createdby = users_createdby.id
LEFT JOIN
    users AS users_assignedto ON tickets.assignedto = users_assignedto.id
LEFT JOIN
    users AS users_closedby ON tickets.closedby = users_closedby.id`;async function o(e){let t=await (0,a.C)(),s={text:`
    select * from userrole_mapping ur
    where ur.category_id = $1`,values:[e]};return await t.query(s)}async function u(e){let t=await (0,a.C)();try{let s=JSON.parse(e),r=await (0,d.getUserIdFromClerkId)(s.created_by);console.log("userId while posting ticket",r);let a=await o(s.sub_category_id),i={sub_category_id:s.sub_category_id,priority:s.priority,title:s.title,description:s.description,status_id:1,created_by:r,assigned_to:a.data&&0!=a.data.length?a.data[0].user_id:null},c={text:"insert into tickets (title, description, subcategory_id, priority, status, createdby, assignedto) values ($1, $2, $3, $4, $5, $6, $7)",values:[i.title,i.description,i.sub_category_id,i.priority,i.status_id,r,i.assigned_to]};return await t.query(c),!0}catch(e){return!1}}async function b(e,t){let s=await (0,a.C)();try{await s.query({text:"update tickets set assignedto = $1 where id = $2",values:[t,e]});let r=await s.query({text:"select email from Users where id = $1",values:[t]}),a=await s.query({text:"select title, description from tickets where id=$1",values:[e]});if(r.rowCount>0){let e=r.rows[0].email,t=a.rows[0].title,s=a.rows[0].description;console.log(e);let i={to:e,subject:"Update: New Ticket Assigned",message:`
      <h3>A new ticket has been assigned, please check your HrSquared Account!</h3>
      <h4>Title: ${t}</h4>
      <p>Description: ${s}</p>
      `};console.log(i,"**********"),await c(i)}return!0}catch(e){return!1}}async function f(e,t){let s=await (0,a.C)();try{await s.query({text:"update tickets set status = $1, closedat=CURRENT_TIMESTAMP where id = $2 RETURNING id",values:[t,e]});let r=await s.query({text:"select title, description, createdby from tickets where id=$1",values:[e]}),a=r.rows[0].createdby,i=(await s.query({text:"select username, email from users where id=$1",values:[a]})).rows[0].email,d=r.rows[0].title,n=r.rows[0].description,l=await s.query({text:"select name from ticketstatus where id=$1",values:[t]}),o={to:i,subject:`Update: Ticket #${e} Status Updated`,message:`
    <h3>Your ticket #${e} status has been updated</h3>
    <h4>Title: ${d}</h4>
    <p>Description: ${n}</p>
    <p>Current status: ${l.rows[0].name}</p>
    `};return console.log(o,"**********"),await c(o),!0}catch(e){return!1}}async function p(e){let t=await (0,a.C)();try{return await t.query({text:"update tickets set status = 1, assignedto=null where id = $1 RETURNING id",values:[e]}),!0}catch(e){return!1}}async function x(e){let t=await (0,a.C)(),s=await (0,d.getUserIdFromClerkId)(e);console.log("ID",s);let r={text:`${l} where users_createdby.id=$1 order by tickets.createdat desc;`,values:[s]};return(await t.query(r)).rows}async function h(){let e=await (0,a.C)(),t={text:`${l} order by tickets.createdat desc;`};return(await e.query(t)).rows}async function m(e){let t=await (0,a.C)(),s={text:`${l} where users_assignedto.id=$1;`,values:[await (0,d.getUserIdFromClerkId)(e)]};return(await t.query(s)).rows}async function g(){let e=await (0,a.C)(),t=await e.query("select * from groups"),s=await e.query("select * from category"),r=await e.query("select * from ticketpriority");return{groups:t.rowCount>0?t.rows:[],categories:s.rowCount>0?s.rows:[],ticketpriority:r.rowCount>0?r.rows:[]}}(0,n.h)([o,u,b,f,p,x,h,m,g]),(0,r.j)("c209c09362fa20cbed56af258953b52262feaccc",o),(0,r.j)("777da57429d2269445386e1c1705a5a5327ec0fd",u),(0,r.j)("b6558d937610141ed48787f4792a92cd116d0873",b),(0,r.j)("92a6dade841af0fa08376101f1391bd44b18dafb",f),(0,r.j)("f4c14cd734994430527605c5c534be48cfc3582a",p),(0,r.j)("ab9d7ea00ff0dbb00ad42d5a0edc121994b61750",x),(0,r.j)("6b04dd2f52e628e3ef8237caef2a3981589e0945",h),(0,r.j)("0d3b394a6f5b2ee7d22e897eaecc161123665419",m),(0,r.j)("75a8f0df29fbc5d9ed038a63256389ddcaf318c4",g)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[377,848,923,349,621,203,245,105],()=>s(75916));module.exports=r})();